## Codebase Patterns
- UI project located in ui/ directory
- Use Vite + React + TypeScript
- Tailwind CSS for styling with Linq brand colors
- shadcn/ui for component library foundation
- React Router v6 for routing
- React Query (TanStack Query) for server state management
- Zustand for client state (theme, settings)
- Geist font family for typography (Geist for body, Geist Mono for code/numerals)
- Dark mode: use #141414 for backgrounds, #FFFFFF for text
- Light mode: use #FCF9E9 (cream) for backgrounds, #141414 for text
- Linq brand colors: navy (#1B3D67), linq-blue (#4F9FDF), linq-green (#83B149), sage (#B0BFB7), lime (#E8DF6E)
- Status colors: healthy (#83B149), warning (#CA8A04 light / #EAB308 dark), error (#DC2626 light / #EF4444 dark)
- API authentication via API key in Authorization header (Bearer token)
- Store API key in sessionStorage, not localStorage

- ESLint 9 uses flat config (eslint.config.js) instead of legacy .eslintrc.js
- For custom fonts in Vite, copy font files to public/fonts/ and reference via /fonts/ path in CSS
- shadcn/ui components installed to src/components/ui/ with path alias @/* -> ./src/*
- cn() utility in src/lib/utils.ts for conditional class merging
- Root .gitignore has `lib/` which ignores ui/src/lib/ - use `git add -f` for lib files

- Provider components (e.g., ThemeProvider) export both component and hook - add ESLint override in eslint.config.js
- Static assets (images, logos) go in ui/public/ and are served at root path (e.g., /assets/logo.png)

- Layout component pattern: use Outlet for nested route rendering in React Router v6
- Mobile navigation: use shadcn/ui Sheet component with side="left" for drawer pattern
- Responsive breakpoints: md: (768px) is standard breakpoint to hide/show sidebar
- tsconfig.app.json has erasableSyntaxOnly: true - don't use public constructor parameters in classes
- API client factory pattern: createApiClient() returns object with methods, allows setApiKey() for runtime config

- AuthProvider pattern: use useMemo for context value to avoid unnecessary re-renders
- AuthContext syncs API key to apiClient.setApiKey() on login/logout for consistent API calls

- Login page pattern: place standalone auth pages (Login) outside Layout Route in App.tsx
- TypeScript verbatimModuleSyntax: use `type` keyword for type imports (e.g., `import { useState, type FormEvent }`)
- shadcn/ui Input component uses CSS variable classes (border-input, ring, etc.) from index.css
- ProtectedRoute pattern: wrap layout/routes with component that checks isAuthenticated and redirects to /login
- React Query hooks pattern: create query key factories (e.g., servicesKeys) for consistent cache key management
- React Query hooks pattern: export filters interface and separate hooks for list/detail queries

- Dashboard summary cards pattern: use Card with CardHeader, CardTitle, CardContent for consistent styling
- Skeleton component for loading states: use animate-pulse with bg-primary/10
- Status color classes: text-status-healthy, text-status-error for conditional coloring
- shadcn CLI creates files in literal @/ directory - must move to src/components/ui/
- Services table pattern: use Table component with TableHeader, TableBody, TableRow, TableHead, TableCell
- Badge component for status indicators: variant="default" for active, variant="secondary" for inactive
- Priority badge styling: use custom className for P1 (error), P2 (warning), P3 (muted)
- Empty state pattern: centered flex column with icon, heading, and description
- Table loading state: use Skeleton components for entire rows

---

## 2026-02-04 - US-019 - Linear Issue: SRE-67
- What was implemented: Created Services list page with table displaying all registered services
- Files changed:
  - ui/src/pages/Services.tsx (replaced placeholder with full table implementation)
  - ui/src/components/ui/table.tsx (new - shadcn/ui Table component)
  - ui/src/components/ui/badge.tsx (new - shadcn/ui Badge component)
- **Learnings for future iterations:**
  - Table component from shadcn/ui wraps table in div with overflow-auto for responsive scrolling
  - Use font-mono for heartbeat_name column for better readability of identifiers
  - Link to detail pages with react-router-dom Link component
  - Eye/EyeOff icons from lucide-react for muted status
  - Service type from api.ts can be imported with `import type { Service }` for type-only usage
  - Status colors: text-status-healthy for green, text-status-error for red
---

## 2026-02-04 - US-018 - Linear Issue: SRE-66
- What was implemented: Created Dashboard page with summary cards showing service health metrics
- Files changed:
  - ui/src/pages/Dashboard.tsx (replaced placeholder with full implementation)
  - ui/src/hooks/use-alerts.ts (new - useAlerts React Query hook)
  - ui/src/hooks/index.ts (added useAlerts export)
  - ui/src/components/ui/skeleton.tsx (new - shadcn/ui Skeleton component)
- **Learnings for future iterations:**
  - Use font-mono class for numeric values in cards for better readability
  - useServices() and useAlerts() return ApiResponse<T[]> - access data via data?.results ?? []
  - Combine isLoading states from multiple queries: isLoading = isLoadingServices || isLoadingAlerts
  - Error handling pattern: check hasError and display styled error banner with icon
  - Color scheme: text-status-healthy for green (#83B149), text-status-error for red (#DC2626)
  - Grid layout: grid gap-4 md:grid-cols-2 lg:grid-cols-4 for responsive card layout
---

## 2026-02-04 - US-017 - Linear Issue: SRE-88
- What was implemented: Installed React Query and created QueryClient with sensible defaults for data fetching
- Files changed:
  - ui/package.json (added @tanstack/react-query dependency)
  - ui/src/main.tsx (added QueryClient and QueryClientProvider)
  - ui/src/hooks/use-services.ts (new - useServices and useService query hooks)
  - ui/src/hooks/index.ts (new - barrel export for hooks)
- **Learnings for future iterations:**
  - React Query v5 renamed cacheTime to gcTime (garbage collection time)
  - QueryClientProvider should wrap BrowserRouter and other providers for universal access
  - Query key factory pattern: create object with all, lists, list(filters), details, detail(id) methods
  - Use Omit<UseQueryOptions<...>, 'queryKey' | 'queryFn'> to allow custom options while enforcing core props
  - staleTime: 30s is good default for dashboard data that doesn't change frequently
  - gcTime: 5 minutes keeps unused data around for back navigation without refetch
---

## 2026-02-04 - US-016 - Linear Issue: SRE-61
- What was implemented: Created ProtectedRoute component to redirect unauthenticated users to login
- Files changed:
  - ui/src/components/protected-route.tsx (new - ProtectedRoute component)
  - ui/src/App.tsx (wrapped Layout route with ProtectedRoute)
- **Learnings for future iterations:**
  - ProtectedRoute pattern: check isAuthenticated from context, redirect with Navigate component
  - Preserve attempted URL in location state for redirect after login (from: location)
  - Wrap parent layout Route element, not individual child routes (DRY)
  - Use `replace` on Navigate to avoid back button issues
---

## 2026-02-04 - US-015 - Linear Issue: SRE-61
- What was implemented: Created Login page with API key input, validation, and navigation
- Files changed:
  - ui/src/pages/Login.tsx (new - Login page component with form)
  - ui/src/components/ui/input.tsx (new - shadcn/ui Input component)
  - ui/src/pages/index.ts (added Login export)
  - ui/src/App.tsx (added /login route outside Layout)
- **Learnings for future iterations:**
  - Login page should be outside Layout Route (standalone, no sidebar/header)
  - Use createApiClient() with temporary API key to test validation before storing
  - Health endpoint (/health) is unauthenticated - use getHealth() for connectivity test only
  - Show specific error messages for different HTTP status codes (401, 403, etc.)
  - Use Loader2 icon with animate-spin for loading states
  - Use KeyRound icon for API key input field visual
  - AlertCircle icon with destructive color scheme for error messages
---

## 2026-02-04 - US-014 - Linear Issue: SRE-61
- What was implemented: Created AuthContext with authentication state and methods for API key management
- Files changed:
  - ui/src/components/auth-provider.tsx (new - AuthProvider context and useAuth hook)
  - ui/src/main.tsx (wrapped App in AuthProvider)
- **Learnings for future iterations:**
  - AuthProvider follows same pattern as ThemeProvider with createContext + useContext
  - sessionStorage used for API key (not localStorage) per security requirements
  - useCallback for login/logout to prevent unnecessary re-renders
  - useMemo for context value object to prevent unnecessary consumer re-renders
  - apiClient.setApiKey() synced whenever API key changes (login/logout)
  - ESLint rule override for *-provider.tsx files already in eslint.config.js
---

## 2026-02-04 - US-013 - Linear Issue: SRE-61
- What was implemented: Created API client module with TypeScript types for communicating with Medic backend
- Files changed:
  - ui/src/lib/api.ts (new - API client module)
- **Learnings for future iterations:**
  - TypeScript erasableSyntaxOnly restricts constructor parameter properties - declare fields separately
  - Use `git add -f` for files in ui/src/lib/ due to root .gitignore pattern
  - API client pattern: factory function returns object with methods for each endpoint
  - ApiError class extends Error with status and response properties for error handling
  - Fetch-based client with Bearer token in Authorization header
  - TypeScript types for all entities: Service, Alert, Heartbeat, AuditLogEntry, Playbook
  - Methods return ApiResponse<T> for consistent response envelope handling
---

## 2026-02-04 - US-012 - Linear Issue: SRE-64
- What was implemented: Created main Layout component with responsive sidebar and mobile navigation
- Files changed:
  - ui/src/components/layout.tsx (new - Layout component with DesktopSidebar, MobileSidebar, Header)
  - ui/src/components/ui/sheet.tsx (new - shadcn/ui Sheet component for mobile drawer)
  - ui/src/App.tsx (refactored to use Layout with nested Routes pattern via Outlet)
  - ui/package.json (added @radix-ui/react-dialog dependency)
- **Learnings for future iterations:**
  - React Router v6 nested routes: parent Route with element={<Layout />} renders child routes via <Outlet />
  - Responsive sidebar pattern: hidden (hidden md:flex) on mobile, visible on desktop
  - Mobile sidebar uses Sheet component (slides from left) with same NavItem structure
  - Hamburger menu button uses Menu icon from lucide-react, hidden on desktop (md:hidden)
  - Sheet component uses @radix-ui/react-dialog under the hood
  - shadcn CLI still creates files in literal @/ directory - must move to src/components/ui/
---

## 2026-02-04 - US-011 - Linear Issue: SRE-64
- What was implemented: Created Header component with Medic logo and theme toggle
- Files changed:
  - ui/src/components/header.tsx (new - Header component with logo and ThemeToggle)
  - ui/src/App.tsx (refactored to use Header component instead of inline header)
  - ui/public/assets/medic-icon-all-green.png (new - copied from docs/assets/)
- **Learnings for future iterations:**
  - For Vite projects, static assets like logos should be copied to ui/public/ directory
  - Assets in public/ are served at root path (e.g., /assets/medic-icon-all-green.png)
  - Header component pattern: flex container with logo+title on left, actions (ThemeToggle) on right
---

## 2026-02-04 - US-010 - Linear Issue: SRE-64
- What was implemented: Created sidebar navigation component with Lucide icons and active link highlighting
- Files changed:
  - ui/src/components/sidebar.tsx (new - Sidebar component with NavLink)
  - ui/src/App.tsx (refactored to use Sidebar instead of horizontal nav)
- **Learnings for future iterations:**
  - Lucide icons: LayoutDashboard, Server, AlertTriangle, BookOpen, ScrollText, Settings for nav items
  - Use useLocation() hook to determine active nav link
  - NavItem pattern with interface { to, label, icon } for extensible navigation
  - Sidebar uses flex layout with flex-shrink-0 to prevent icon squishing
  - cn() utility from lib/utils for conditional class merging
---

## 2026-02-04 - US-009 - Linear Issue: SRE-87
- What was implemented: Installed React Router v6 and created basic routes with placeholder pages
- Files changed:
  - ui/package.json (added react-router-dom dependency)
  - ui/src/main.tsx (added BrowserRouter wrapper)
  - ui/src/App.tsx (replaced demo content with Routes configuration and NavLink component)
  - ui/src/pages/Dashboard.tsx (new - placeholder page)
  - ui/src/pages/Services.tsx (new - placeholder page)
  - ui/src/pages/Alerts.tsx (new - placeholder page)
  - ui/src/pages/Playbooks.tsx (new - placeholder page)
  - ui/src/pages/AuditLogs.tsx (new - placeholder page)
  - ui/src/pages/Settings.tsx (new - placeholder page)
  - ui/src/pages/index.ts (new - barrel export for all pages)
- **Learnings for future iterations:**
  - React Router v6 uses Routes/Route components (not Switch from v5)
  - BrowserRouter should wrap the entire app in main.tsx
  - Create a pages/ directory with barrel export (index.ts) for clean imports
  - NavLink helper component with useLocation() for active link highlighting
  - Path aliases (@/pages) work for page imports same as components
---

## 2026-02-04 - US-008 - Linear Issue: SRE-60
- What was implemented: Created ThemeProvider with dark mode support
- Files changed:
  - ui/src/components/theme-provider.tsx (new - ThemeProvider context and useTheme hook)
  - ui/src/components/theme-toggle.tsx (new - ThemeToggle button with sun/moon icons)
  - ui/src/main.tsx (wrapped App in ThemeProvider)
  - ui/src/App.tsx (added ThemeToggle button in top-right corner)
  - ui/eslint.config.js (added rule override for *-provider.tsx files)
- **Learnings for future iterations:**
  - ThemeProvider uses React context with useState for theme state (light/dark/system)
  - Theme is applied by adding/removing 'dark' class on document.documentElement
  - localStorage persistence with configurable storage key (medic-ui-theme)
  - ThemeToggle cycles through light -> dark -> system on click
  - ESLint react-refresh rule needs override for files that export both components and hooks
---

## 2026-02-04 - US-007 - Linear Issue: SRE-86
- What was implemented: Installed shadcn/ui component library with Button and Card components
- Files changed:
  - ui/components.json (new - shadcn/ui configuration)
  - ui/tsconfig.app.json (added path aliases @/* -> ./src/*)
  - ui/vite.config.ts (added path alias resolution)
  - ui/src/lib/utils.ts (new - cn() utility function)
  - ui/src/components/ui/button.tsx (new - shadcn Button component)
  - ui/src/components/ui/card.tsx (new - shadcn Card component)
  - ui/src/index.css (added shadcn/ui CSS variables for theming)
  - ui/tailwind.config.js (added darkMode, color system with CSS variables, borderRadius)
  - ui/eslint.config.js (added rule override for shadcn/ui component exports)
  - ui/package.json (added class-variance-authority, clsx, tailwind-merge, lucide-react, @radix-ui/react-slot)
  - ui/src/App.tsx (updated to demonstrate Button and Card components)
- **Learnings for future iterations:**
  - shadcn CLI creates files in literal `@/` directory - must move to src/components/ui/
  - Tailwind v4 doesn't support `@apply` with custom CSS variable colors like `border-border` - use raw CSS
  - shadcn/ui uses CSS variables for theming - define in :root for light mode, .dark for dark mode
  - Values must be space-separated RGB like `20 20 20` not hex `#141414`
  - ESLint react-refresh rule must be disabled for ui components that export utilities alongside components
---

## 2026-02-04 - US-006 - Linear Issue: SRE-60
- What was implemented: Installed Geist font family for brand-compliant typography
- Files changed:
  - ui/package.json (added geist dependency)
  - ui/public/fonts/Geist-Variable.woff2 (new)
  - ui/public/fonts/GeistMono-Variable.woff2 (new)
  - ui/src/index.css (added @font-face declarations and --font-sans/--font-mono CSS variables)
  - ui/tailwind.config.js (added fontFamily configuration)
  - ui/src/App.tsx (added font-sans class and font-mono demo)
- **Learnings for future iterations:**
  - The `geist` npm package is designed for Next.js - for Vite projects, copy font files to public/fonts/
  - Use variable fonts (Geist-Variable.woff2) for flexibility with font-weight 100-900
  - In Tailwind v4, configure fonts in @theme block with --font-sans and --font-mono CSS variables
  - Also add fontFamily to tailwind.config.js for IDE/TypeScript support
---

## 2026-02-04 - US-002 - Linear Issue: SRE-59
- What was implemented: Verified ESLint and Prettier are already configured correctly
- Files changed: None (already complete from prior work)
- ESLint 9 flat config at ui/eslint.config.js with TypeScript, React Hooks, and Prettier integration
- Prettier config at ui/.prettierrc with project conventions
- npm scripts: `lint`, `lint:fix`, `format` all working
- **Learnings for future iterations:**
  - ESLint 9 uses eslint.config.js (flat config) instead of .eslintrc.js
  - eslint-config-prettier disables ESLint formatting rules that conflict with Prettier
  - Package @typescript-eslint handles TypeScript-specific linting
---

## 2026-02-04 - US-001 - Linear Issue: SRE-59
- What was implemented: Verified React + Vite + TypeScript project scaffolding is complete; updated App.tsx heading from "Medic" to "Medic UI" per acceptance criteria
- Files changed: ui/src/App.tsx
- **Learnings for future iterations:**
  - The ui/ directory was already scaffolded with Vite + React + TypeScript in prior work
  - tsconfig.app.json (not tsconfig.json) contains the strict mode configuration
  - Tailwind CSS and brand colors were already configured in US-003, US-004, US-005
---

